<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>eatmi.pl ‚Äî Zam√≥w online</title>
  <meta name="description" content="eatmi.pl ‚Äî Boxy ≈õniadaniowe, lunche, kanapki, zdrowe, s≈Çodkie i napoje." />
  <meta name="theme-color" content="#0B1220" />
  <link rel="icon" type="image/png" href="favicon.png">
  <link rel="manifest" href="/manifest.webmanifest">

  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            brand: {
              y: '#FFC107',
              y2: '#FFB000',
              ink: '#0B1220',
              ink2: '#111827',
              bg: '#0B1220',
              surface: 'rgba(255,255,255,.08)',
              stroke: 'rgba(255,255,255,.14)',
              glass: 'rgba(255,255,255,.10)',
              soft: '#F7F7FB'
            }
          },
          boxShadow: {
            glow: '0 18px 90px rgba(255,193,7,.18)',
            soft: '0 10px 34px rgba(2,6,23,.12)',
            heavy: '0 25px 90px rgba(2,6,23,.30)',
            glass: '0 16px 60px rgba(2,6,23,.24)'
          },
          borderRadius: { xl2: '1.25rem', xl3: '1.75rem' }
        }
      }
    }
  </script>

  <script src="https://unpkg.com/lucide@latest"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <style>
    :root{
      --ring: rgba(255,193,7,.42);
      --ring2: rgba(59,130,246,.28);
      --glass: rgba(255,255,255,.08);
      --stroke: rgba(255,255,255,.14);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.68);
      --muted2: rgba(255,255,255,.52);
      --bg: #0B1220;
      --bg2: #0A1020;
      --y: #FFC107;
    }

    html{ scroll-behavior:smooth; }
    body{
      margin:0;
      background:
        radial-gradient(1200px 600px at 20% -10%, rgba(255,193,7,.28), transparent 60%),
        radial-gradient(1100px 700px at 85% 10%, rgba(59,130,246,.18), transparent 60%),
        radial-gradient(900px 540px at 60% 120%, rgba(168,85,247,.12), transparent 62%),
        linear-gradient(180deg, var(--bg), var(--bg2));
      color: var(--text);
      -webkit-font-smoothing: antialiased;
      text-rendering: optimizeLegibility;
      overflow-x:hidden;
    }

    *{ -webkit-tap-highlight-color: transparent; }
    a, button { touch-action: manipulation; }

    .glass{
      background: var(--glass);
      border: 1px solid var(--stroke);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
    }

    .card{
      background: rgba(255,255,255,.085);
      border: 1px solid rgba(255,255,255,.14);
      box-shadow: 0 18px 60px rgba(0,0,0,.25);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
    }

    .chip{
      background: rgba(255,255,255,.10);
      border: 1px solid rgba(255,255,255,.14);
    }

    .focusRing:focus{
      outline: none;
      box-shadow: 0 0 0 4px var(--ring);
    }

    .softShadow{ box-shadow: 0 10px 35px rgba(0,0,0,.25); }
    .textMuted{ color: var(--muted); }
    .textMuted2{ color: var(--muted2); }

    .appTop{ padding-top: env(safe-area-inset-top); }
    .appBottom{ padding-bottom: env(safe-area-inset-bottom); }

    @keyframes floaty{
      0%,100%{ transform: translateY(0); }
      50%{ transform: translateY(-6px); }
    }

    @keyframes pop{
      0%{ transform: translateY(12px) scale(.98); opacity:0; }
      70%{ transform: translateY(0) scale(1.02); opacity:1; }
      100%{ transform: translateY(0) scale(1); opacity:1; }
    }
    .pop{ animation: pop .35s ease-out both; }

    @keyframes shimmer{
      0%{ transform: translateX(-60%); opacity:.0; }
      20%{ opacity:.45; }
      100%{ transform: translateX(220%); opacity:0; }
    }
    .shine::after{
      content:"";
      position:absolute; inset:-40%;
      background: linear-gradient(115deg, transparent, rgba(255,255,255,.28), transparent);
      transform: translateX(-70%);
      animation: shimmer 2.6s ease-in-out infinite;
      pointer-events:none;
    }

    /* Desktop / Mobile layout switching */
    @media (max-width: 980px){
      .desktopOnly{ display:none !important; }
      .mobileOnly{ display:block !important; }
    }
    @media (min-width: 981px){
      .mobileOnly{ display:none !important; }
      .desktopOnly{ display:block !important; }
    }

    /* Mobile ‚Äúapp-like‚Äù sizing */
    @media (max-width: 980px){
      .tapBtn{ height: 54px; border-radius: 18px; font-weight: 900; letter-spacing: .2px; }
      .tapCard{ border-radius: 26px; }
    }

    /* Under construction overlay (kept) */
    .uc-overlay{
      position: fixed; inset: 0; z-index: 9999;
      background: rgba(0,0,0,0.45);
      backdrop-filter: blur(18px);
      -webkit-backdrop-filter: blur(18px);
      display: grid; place-items: center; padding: 16px;
    }
    .uc-card{
      width: min(640px, 94vw);
      background: rgba(15,23,42,0.92);
      border: 1px solid rgba(255,255,255,0.18);
      border-radius: 24px;
      box-shadow: 0 18px 70px rgba(0,0,0,.50);
      padding: 22px; text-align: center;
      color: rgba(255,255,255,.92);
    }
    .uc-title{ font-size: clamp(22px, 3vw, 30px); font-weight: 900; }
    .uc-sub{ margin-top: 6px; font-size: 14px; color: rgba(255,255,255,.72); }
    .uc-input{
      width: 100%;
      border: 1px solid rgba(255,255,255,.18);
      border-radius: 14px;
      padding: 12px 14px; outline: none;
      background: rgba(255,255,255,.08);
      color: rgba(255,255,255,.92);
    }
    .uc-input:focus{ box-shadow: 0 0 0 4px rgba(255,193,7,.28); border-color: rgba(255,193,7,.45); }
    .uc-btn{
      width: 100%; margin-top: 8px;
      background: linear-gradient(135deg, #FFC107, #FFB000);
      color: #0B1220; font-weight: 900;
      padding: 12px 14px; border-radius: 14px;
      box-shadow: 0 14px 50px rgba(255,193,7,.18);
    }
    .uc-btn[disabled]{ opacity: .65; cursor: not-allowed; }
    .uc-dev{
      position: fixed; right: 10px; bottom: 10px; z-index: 10000;
      font-size: 11px; background: rgba(0,0,0,.55); color: white;
      padding: 6px 10px; border-radius: 999px;
      border: 1px solid rgba(255,255,255,.18);
      backdrop-filter: blur(12px);
    }
  </style>
</head>

<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useMemo, useRef } = React;

    /* =======================
       TWOJE PRAWDZIWE MENU
    ======================= */

    const PRODUCT_CATEGORIES = [
      { id: 'boxy-sniadaniowe', name: 'Boxy ≈õniadaniowe', icon: 'package-open', description: 'Ma≈Çe, ≈õrednie i du≈ºe zestawy. Tak≈ºe VEGE.' },
      { id: 'lunche', name: 'Lunche', icon: 'utensils-crossed', description: 'Lunch tygodnia, miesiƒÖca i vege (12:00‚Äì16:00).' },
      { id: 'kanapki', name: 'Kanapki', icon: 'sandwich', description: 'Kanapki i buritto na ma≈õlanym pieczywie.' },
      { id: 'zdrowe', name: 'Zdrowe', icon: 'leaf', description: 'Granola i sa≈Çatki w wersjach fit.' },
      { id: 'slodkie', name: 'S≈Çodkie', icon: 'ice-cream', description: 'Desery, pancakes, tost francuski i smoothie.' },
      { id: 'napoje', name: 'Napoje', icon: 'cup-soda', description: 'Kawy, herbaty, lemoniada i sok.' },
    ];

    const BREAKFAST_BOXES = [
      { id:'bs-small-1', name:'Box ≈õniadaniowy ma≈Çy nr 1', price: 38, subtitle:'Kanapka z jajecznicƒÖ i bekonem, majonez sriracha ‚Ä¢ Domowa granola z jogurtem greckim, owocami i miodem ‚Ä¢ Sok pomara≈Ñczowy 250 ml' },
      { id:'bs-small-2', name:'Box ≈õniadaniowy ma≈Çy nr 2', price: 40, subtitle:'Buritto z jajecznicƒÖ i chorizo ‚Ä¢ Sa≈Çatka korea≈Ñska z kurczakiem w panko, warzywami i sezamem ‚Ä¢ Sok pomara≈Ñczowy 250 ml' },
      { id:'bs-small-3', name:'Box ≈õniadaniowy ma≈Çy nr 3', price: 42, subtitle:'Kanapka z rostbefem, jajkiem poche, sosem musztardowo-chrzanowym i oliwƒÖ truflowƒÖ ‚Ä¢ Sa≈Çatka Cezar z kurczakiem, bekonem, sa≈ÇatƒÖ rzymskƒÖ i grzankami ‚Ä¢ Sok pomara≈Ñczowy 250 ml' },
      { id:'bs-small-vege', name:'Box ≈õniadaniowy ma≈Çy VEGE', price: 38, subtitle:'Kanapka z jajecznicƒÖ i awokado, majonez sriracha ‚Ä¢ Sa≈Çatka z carpaccio z buraka z kozim serem i orzechami pekan, mix sa≈Çat, pomara≈Ñczowy dressing z oliwƒÖ ‚Ä¢ Sok pomara≈Ñczowy 250 ml' },

      { id:'bs-med-1', name:'Box ≈õniadaniowy ≈õredni nr 1', price: 52, subtitle:'Kanapka z jajecznicƒÖ i bekonem, majonez sriracha ‚Ä¢ Domowa granola z jogurtem greckim, owocami i miodem ‚Ä¢ Tost francuski z owocami i miodem ‚Ä¢ Sok pomara≈Ñczowy 250 ml' },
      { id:'bs-med-2', name:'Box ≈õniadaniowy ≈õredni nr 2', price: 54, subtitle:'Buritto z jajecznicƒÖ i chorizo ‚Ä¢ Sa≈Çatka korea≈Ñska z kurczakiem w panko, warzywami i sezamem ‚Ä¢ Pancakes (2 szt.) z NutellƒÖ i owocami ‚Ä¢ Sok pomara≈Ñczowy 250 ml' },
      { id:'bs-med-3', name:'Box ≈õniadaniowy ≈õredni nr 3', price: 56, subtitle:'Kanapka z rostbefem, jajkiem poche, sosem musztardowo-chrzanowym i oliwƒÖ truflowƒÖ ‚Ä¢ Sa≈Çatka Cezar z kurczakiem, bekonem, sa≈ÇatƒÖ rzymskƒÖ i grzankami ‚Ä¢ Deser czekoladowy z owocami i kruszonkƒÖ ‚Ä¢ Sok pomara≈Ñczowy 250 ml' },
      { id:'bs-med-vege', name:'Box ≈õniadaniowy ≈õredni VEGE', price: 52, subtitle:'Kanapka z jajecznicƒÖ i awokado, majonez sriracha ‚Ä¢ Sa≈Çatka z carpaccio z buraka z kozim serem i orzechami pekan, mix sa≈Çat, pomara≈Ñczowy dressing z oliwƒÖ ‚Ä¢ Smoothie Mango Lassi z miodem ‚Ä¢ Sok pomara≈Ñczowy 250 ml' },

      { id:'bs-big-1', name:'Box ≈õniadaniowy du≈ºy nr 1', price: 80, subtitle:'Kanapka z jajecznicƒÖ i bekonem, majonez sriracha ‚Ä¢ Club sandwich z kurczakiem i bekonem, majonez, sa≈Çata, pomidor ‚Ä¢ Domowa granola z jogurtem greckim, owocami i miodem ‚Ä¢ Sa≈Çatka Cezar z kurczakiem, bekonem, sa≈ÇatƒÖ rzymskƒÖ i grzankami ‚Ä¢ Tost francuski z owocami i miodem ‚Ä¢ Sok pomara≈Ñczowy 250 ml' },
      { id:'bs-big-2', name:'Box ≈õniadaniowy du≈ºy nr 2', price: 82, subtitle:'Buritto z jajecznicƒÖ i chorizo ‚Ä¢ Kanapka z jajecznicƒÖ i bekonem, majonez sriracha ‚Ä¢ Sa≈Çatka korea≈Ñska z kurczakiem w panko, warzywami i sezamem ‚Ä¢ Domowa granola z jogurtem greckim, owocami i miodem ‚Ä¢ Pancakes (2 szt.) z NutellƒÖ i owocami ‚Ä¢ Sok pomara≈Ñczowy 250 ml' },
      { id:'bs-big-3', name:'Box ≈õniadaniowy du≈ºy nr 3', price: 84, subtitle:'Kanapka z rostbefem, jajkiem poche, sosem musztardowo-chrzanowym i oliwƒÖ truflowƒÖ ‚Ä¢ Kanapka z jajecznicƒÖ i bekonem, majonez sriracha ‚Ä¢ Sa≈Çatka Cezar z kurczakiem, bekonem, sa≈ÇatƒÖ rzymskƒÖ i grzankami ‚Ä¢ Domowa granola z jogurtem greckim, owocami i miodem ‚Ä¢ Deser czekoladowy z owocami i kruszonkƒÖ ‚Ä¢ Sok pomara≈Ñczowy 250 ml' },
      { id:'bs-big-vege', name:'Box ≈õniadaniowy du≈ºy VEGE', price: 80, subtitle:'Kanapka z jajecznicƒÖ i awokado, majonez sriracha ‚Ä¢ Vege club sandwich z camembert i awokado, majonez, sa≈Çata, pomidor ‚Ä¢ Sa≈Çatka z carpaccio z buraka z kozim serem i orzechami pekan, mix sa≈Çat, pomara≈Ñczowy dressing z oliwƒÖ ‚Ä¢ Domowa granola z jogurtem greckim, owocami i miodem ‚Ä¢ Smoothie Mango Lassi z miodem ‚Ä¢ Sok pomara≈Ñczowy 250 ml' },
    ];

    const LUNCHES = [
      { id:'lunch-week', name:'Lunch tygodnia', price: 49, subtitle:'Dostƒôpny 12:00‚Äì16:00 ‚Ä¢ Zupa krem z pieczonych burak√≥w 200 ml ‚Ä¢ Corn Flake Chicken: panierowana w p≈Çatkach kukurydzianych pier≈õ z kurczaka z ziemniaczanym puree i coleslawem ‚Ä¢ Domowa lemoniada 250 ml' },
      { id:'lunch-month', name:'Lunch miesiƒÖca', price: 59, subtitle:'Dostƒôpny 12:00‚Äì16:00 ‚Ä¢ Zupa krem z pieczonych burak√≥w 200 ml ‚Ä¢ Kurczak Supreme: pieczona pier≈õ z kurczaka z ziemniaczanym puree, warzywami i sosem demi glace ‚Ä¢ Domowa lemoniada 250 ml' },
      { id:'lunch-vege', name:'Lunch VEGE', price: 49, subtitle:'Dostƒôpny 12:00‚Äì16:00 ‚Ä¢ Zupa krem z pieczonych burak√≥w 200 ml ‚Ä¢ Tagliatelle z warzywami, oliwƒÖ z oliwek i pastƒÖ truflowƒÖ ‚Ä¢ Domowa lemoniada 250 ml' },
    ];

    const SANDWICHES = [
      { id:'k-jajecznica-bekon', name:'Ma≈õlane pieczywo z jajecznicƒÖ, bekonem i majonezem sriracha', price: 17 },
      { id:'k-club-kurczak', name:'Club sandwich z grillowanym kurczakiem, chrupiƒÖcy bekon, majonez, sa≈Çata i pomidor', price: 17 },
      { id:'k-club-vege', name:'Vege club sandwich z camembert, palonym awokado, majonezem, sa≈ÇatƒÖ i pomidorem', price: 17 },
      { id:'k-jajecznica-avo', name:'Ma≈õlane pieczywo z jajecznicƒÖ, awokado i majonezem sriracha', price: 17 },
      { id:'k-buritto-chorizo', name:'Buritto z jajecznicƒÖ z mozzarellƒÖ, chorizo i majonezem sriracha', price: 19 },
      { id:'k-rostbef', name:'Ma≈õlane pieczywo z rostbefem, jajkiem poche, rukolƒÖ, sosem musztardowo-chrzanowym i oliwƒÖ truflowƒÖ', price: 21 },
    ];

    const HEALTHY = [
      { id:'z-granola', name:'Domowa granola z jogurtem greckim, owoce i mi√≥d', price: 19 },
      { id:'z-cezar', name:'Sa≈Çatka Cezar z kurczakiem, bekonem, sa≈ÇatƒÖ rzymskƒÖ, parmezanem i grzankami', price: 19 },
      { id:'z-koreanska', name:'Sa≈Çatka korea≈Ñska z kurczakiem w panko, warzywa i sezam, s≈Çodki sos sojowy', price: 19 },
      { id:'z-burak', name:'Sa≈Çatka z carpaccio z buraka i serem kozim, karmelizowane orzechy pekan, mix sa≈Çat i pomara≈Ñczowy dressing', price: 19 },
    ];

    const SWEETS = [
      { id:'s-smoothie', name:'Smoothie Mango Lassi (mango, jogurt grecki, mi√≥d)', price: 19 },
      { id:'s-tost-fr', name:'Tost francuski z owocami i miodem', price: 19 },
      { id:'s-pancakes', name:'Pancakes (2 szt.) z NutellƒÖ i owocami', price: 19 },
      { id:'s-deser-czeko', name:'Deser czekoladowy z owocami i kruszonkƒÖ', price: 19 },
    ];

    const DRINKS = [
      { id:'n-lemoniada', name:'Domowa lemoniada 250 ml', price: 12 },
      { id:'n-sok-pom', name:'Sok pomara≈Ñczowy 250 ml', price: 12 },
      { id:'n-kawa-filt-cz', name:'Kawa filtrowana czarna 300 ml', price: 10 },
      { id:'n-kawa-filt-b', name:'Kawa filtrowana bia≈Ça 300 ml', price: 10 },
      { id:'n-espresso-double', name:'Kawa czarna (podw√≥jne espresso) 300 ml', price: 11 },
      { id:'n-flat-white', name:'Kawa Flat White (podw√≥jne espresso) 300 ml', price: 11 },
      { id:'n-latte', name:'Latte (podw√≥jne espresso) 300 ml', price: 12 },
      { id:'n-cappu', name:'Cappuccino (podw√≥jne espresso) 300 ml', price: 11 },
      { id:'n-matcha', name:'Matcha 300 ml', price: 18 },
      { id:'n-herbata-cz', name:'Herbata czarna z cytrynƒÖ 300 ml', price: 9 },
      { id:'n-zimowa', name:'Zimowa herbata z miodem, cytrusami, go≈∫dzikami i sokiem malinowym 300 ml', price: 15 },
    ];

    const PRODUCTS = {
      'boxy-sniadaniowe': BREAKFAST_BOXES,
      'lunche': LUNCHES,
      'kanapki': SANDWICHES,
      'zdrowe': HEALTHY,
      'slodkie': SWEETS,
      'napoje': DRINKS,
    };

    /* =======================
       UTIL
    ======================= */

    const useLocalStorage = (key, initial) => {
      const [state, setState] = useState(() => {
        try { return JSON.parse(localStorage.getItem(key)) ?? initial } catch { return initial }
      });
      useEffect(() => { localStorage.setItem(key, JSON.stringify(state)) }, [key, state]);
      return [state, setState];
    };

    const currency = (n) => new Intl.NumberFormat('pl-PL', { style:'currency', currency:'PLN' }).format(n);

    const useDisplayMode = () => {
      const get = () => {
        const standalone =
          window.matchMedia?.("(display-mode: standalone)")?.matches ||
          window.navigator.standalone === true;
        const isMobile = window.matchMedia?.("(max-width: 980px)")?.matches;
        return { standalone, isMobile, appLike: standalone || isMobile };
      };
      const [mode, setMode] = useState(get);
      useEffect(() => {
        const mq1 = window.matchMedia("(display-mode: standalone)");
        const mq2 = window.matchMedia("(max-width: 980px)");
        const onChange = () => setMode(get());
        mq1?.addEventListener?.("change", onChange);
        mq2?.addEventListener?.("change", onChange);
        window.addEventListener("resize", onChange);
        return () => {
          mq1?.removeEventListener?.("change", onChange);
          mq2?.removeEventListener?.("change", onChange);
          window.removeEventListener("resize", onChange);
        };
      }, []);
      return mode;
    };

    const splitSubtitle = (text='') =>
      text.split('‚Ä¢').map(s => s.trim()).filter(Boolean);

    const getBadges = (categoryId, name) => {
      const badges = [];
      const upper = (name||'').toUpperCase();
      if (categoryId === 'boxy-sniadaniowe') badges.push({ label: 'BOX', cls: 'bg-white/10 border-white/15 text-white' });
      if (categoryId === 'lunche') badges.push({ label: '12‚Äì16', cls: 'bg-brand-y/20 border-brand-y/40 text-white' });
      if (upper.includes('VEGE')) badges.push({ label: 'VEGE', cls: 'bg-emerald-400/15 border-emerald-400/30 text-white' });
      return badges;
    };

    /* =======================
       TOAST
    ======================= */

    const ToastContext = React.createContext();
    const useToast = () => React.useContext(ToastContext);

    const ToastProvider = ({children}) => {
      const [toast, setToast] = useState(null);
      const t = useRef(null);

      const show = (message) => {
        setToast(message);
        if (t.current) clearTimeout(t.current);
        t.current = setTimeout(() => setToast(null), 2500);
      };

      return (
        <ToastContext.Provider value={{ show }}>
          {children}
          {toast && (
            <div className="fixed bottom-24 md:bottom-6 left-1/2 -translate-x-1/2 z-[90] pop">
              <div className="glass rounded-2xl px-4 py-3 shadow-glass flex items-center gap-3">
                <div className="w-10 h-10 rounded-2xl bg-brand-y/20 border border-brand-y/30 grid place-items-center">
                  <i data-lucide="check" className="w-5 h-5"></i>
                </div>
                <div className="min-w-[220px]">
                  <div className="text-[11px] uppercase tracking-[0.18em] text-white/70 font-bold">Dodano do koszyka</div>
                  <div className="text-sm font-semibold">{toast}</div>
                </div>
              </div>
            </div>
          )}
        </ToastContext.Provider>
      );
    };

    /* =======================
       CART
    ======================= */

    const CartContext = React.createContext();
    const useCart = () => React.useContext(CartContext);

    const CartProvider = ({children}) => {
      const [cart, setCart] = useLocalStorage('eatmi-cart', []);
      const { show } = useToast() || {};

      const add = (entry) => {
        const newItem = { id: (crypto?.randomUUID ? crypto.randomUUID() : `${Date.now()}-${Math.random()}`), qty: 1, ...entry };
        setCart(prev => [...prev, newItem]);
        show?.(entry.name);
      };
      const remove  = (id) => setCart(prev => prev.filter(i => i.id !== id));
      const setQty  = (id, qty) => setCart(prev => prev.map(i => i.id === id ? {...i, qty: Math.max(1, qty|0)} : i));
      const incQty  = (id) => setCart(prev => prev.map(i => i.id === id ? {...i, qty: (i.qty||1)+1} : i));
      const decQty  = (id) => setCart(prev => prev.map(i => i.id === id ? {...i, qty: Math.max(1, (i.qty||1)-1)} : i));
      const clear   = () => setCart([]);
      const lineTotal = (i) => (i.price || 0) * (i.qty || 1);
      const total  = useMemo(() => cart.reduce((s,i)=> s + lineTotal(i), 0), [cart]);
      const count  = useMemo(() => cart.reduce((s,i)=> s + (i.qty||1), 0), [cart]);

      return (
        <CartContext.Provider value={{cart, add, remove, setQty, incQty, decQty, clear, lineTotal, total, count}}>
          {children}
        </CartContext.Provider>
      );
    };

    /* =======================
       BRAND / UI
    ======================= */

    const Logo = () => (
      <a href="#/" className="flex items-center gap-3">
        <div className="relative w-11 h-11 rounded-2xl glass overflow-hidden shadow-soft">
          <div className="absolute inset-0 opacity-60 shine"></div>
          <img
            src="https://i.imgur.com/f9TN0Gh.png"
            alt="eatmi.pl ‚Äî logo"
            loading="lazy"
            className="w-full h-full object-contain p-2"
          />
        </div>
        <div className="leading-tight">
          <div className="font-black tracking-tight text-white text-lg">eatmi<span className="text-brand-y">.pl</span></div>
          <div className="text-[11px] text-white/60 font-semibold">Zam√≥w online ‚Ä¢ szybko</div>
        </div>
      </a>
    );

    const IconPill = ({ icon, children }) => (
      <span className="inline-flex items-center gap-2 chip px-3 py-2 rounded-full text-sm text-white/85">
        <i data-lucide={icon} className="w-4 h-4"></i>
        <span className="font-semibold">{children}</span>
      </span>
    );

    /* =======================
       MOBILE APP BAR + TABS
    ======================= */

    const MobileAppBar = ({ onOpenAuth, onOpenCart }) => {
      const { count, total } = useCart();
      return (
        <div className="mobileOnly sticky top-0 z-50 appTop">
          <div className="px-3 pt-3">
            <div className="glass rounded-3xl px-4 py-3 flex items-center justify-between shadow-glass">
              <Logo />
              <div className="flex items-center gap-2">
                <button className="w-11 h-11 rounded-2xl glass focusRing" onClick={onOpenAuth} aria-label="Konto">
                  <i data-lucide="user" className="w-5 h-5 mx-auto"></i>
                </button>
                <button className="relative h-11 px-3 rounded-2xl bg-brand-y text-brand-ink font-black shadow-glow focusRing" onClick={onOpenCart}>
                  <div className="flex items-center gap-2">
                    <i data-lucide="shopping-cart" className="w-5 h-5"></i>
                    <span className="text-sm">{currency(total)}</span>
                  </div>
                  {count > 0 && (
                    <span className="absolute -top-2 -right-2 w-6 h-6 rounded-full bg-black text-white text-xs grid place-items-center border border-white/20">
                      {count}
                    </span>
                  )}
                </button>
              </div>
            </div>
          </div>

          <div className="px-3 pt-3">
            <div className="flex gap-2 overflow-auto pb-1">
              <IconPill icon="sparkles">Nowo≈õci dzisiaj</IconPill>
              <IconPill icon="timer">Szybko i ≈õwie≈ºo</IconPill>
              <IconPill icon="shield-check">Bezpieczne p≈Çatno≈õci</IconPill>
            </div>
          </div>
        </div>
      );
    };

    const MobileTabs = ({ active, onNav, onOpenCart }) => {
      const Tab = ({ id, icon, label }) => (
        <button
          onClick={() => onNav(id)}
          className={`tapBtn flex flex-col items-center justify-center gap-1 rounded-2xl px-3 w-full ${
            active === id ? "bg-brand-y text-brand-ink shadow-glow" : "glass text-white"
          }`}
        >
          <i data-lucide={icon} className="w-5 h-5"></i>
          <span className="text-[11px] font-black">{label}</span>
        </button>
      );

      return (
        <div className="mobileOnly fixed left-0 right-0 bottom-0 z-[80] appBottom">
          <div className="px-3 pb-3">
            <div className="glass rounded-3xl p-2 shadow-glass">
              <div className="grid grid-cols-4 gap-2">
                <Tab id="home" icon="home" label="Start" />
                <Tab id="menu" icon="layout-grid" label="Menu" />
                <Tab id="search" icon="search" label="Szukaj" />
                <button
                  onClick={onOpenCart}
                  className="tapBtn flex flex-col items-center justify-center gap-1 rounded-2xl px-3 w-full bg-white/10 text-white border border-white/15"
                >
                  <i data-lucide="shopping-cart" className="w-5 h-5"></i>
                  <span className="text-[11px] font-black">Koszyk</span>
                </button>
              </div>
            </div>
          </div>
        </div>
      );
    };

    /* =======================
       DESKTOP SHELL
    ======================= */

    const DesktopTopbar = ({ onOpenAuth, onOpenCart }) => {
      const { count, total } = useCart();
      return (
        <div className="desktopOnly sticky top-0 z-50">
          <div className="px-6 pt-6">
            <div className="glass rounded-3xl px-5 py-4 flex items-center justify-between shadow-glass">
              <Logo />
              <div className="flex items-center gap-3">
                <div className="hidden lg:flex items-center gap-2">
                  <IconPill icon="sparkles">Premium kiosk UI</IconPill>
                  <IconPill icon="truck">Dostawa / odbi√≥r</IconPill>
                </div>
                <button onClick={onOpenAuth} className="h-11 px-4 rounded-2xl glass focusRing">
                  <div className="flex items-center gap-2">
                    <i data-lucide="user" className="w-5 h-5"></i>
                    <span className="font-black">Konto</span>
                  </div>
                </button>
                <button onClick={onOpenCart} className="relative h-11 px-4 rounded-2xl bg-brand-y text-brand-ink font-black shadow-glow focusRing">
                  <div className="flex items-center gap-2">
                    <i data-lucide="shopping-cart" className="w-5 h-5"></i>
                    <span>{currency(total)}</span>
                  </div>
                  {count > 0 && (
                    <span className="absolute -top-2 -right-2 w-6 h-6 rounded-full bg-black text-white text-xs grid place-items-center border border-white/20">
                      {count}
                    </span>
                  )}
                </button>
              </div>
            </div>
          </div>
        </div>
      );
    };

    const DesktopSidebar = ({ activeCat, onPickCat }) => (
      <aside className="desktopOnly w-[320px] shrink-0 px-6 pb-6 pt-6">
        <div className="glass rounded-3xl p-5 shadow-glass sticky top-28">
          <div className="text-sm text-white/60 uppercase tracking-[0.18em] font-black">Kategorie</div>
          <div className="mt-3 grid gap-2">
            {PRODUCT_CATEGORIES.map(c => (
              <button
                key={c.id}
                onClick={() => onPickCat(c.id)}
                className={`text-left rounded-2xl px-4 py-3 border transition focusRing ${
                  activeCat === c.id
                    ? "bg-brand-y/15 border-brand-y/35"
                    : "bg-white/5 border-white/10 hover:bg-white/7"
                }`}
              >
                <div className="flex items-center justify-between gap-3">
                  <div>
                    <div className="font-black">{c.name}</div>
                    <div className="text-xs text-white/60 mt-0.5">{c.description}</div>
                  </div>
                  <div className="w-10 h-10 rounded-2xl glass grid place-items-center">
                    <i data-lucide={c.icon} className="w-5 h-5"></i>
                  </div>
                </div>
              </button>
            ))}
          </div>

          <div className="mt-5 p-4 rounded-2xl bg-white/6 border border-white/10">
            <div className="font-black">Tip</div>
            <div className="text-sm text-white/65 mt-1">
              Na desktopie masz koszyk jako panel ‚Äî dodawaj pozycje i finalizuj bez przechodzenia miƒôdzy stronami.
            </div>
          </div>
        </div>
      </aside>
    );

    /* =======================
       PRODUCT UI
    ======================= */

    const Badge = ({ children, cls }) => (
      <span className={`text-[10px] font-black tracking-[0.18em] uppercase border px-2.5 py-1 rounded-full ${cls}`}>
        {children}
      </span>
    );

    const ProductCard = ({ item, categoryId, onAdd }) => {
      const bullets = splitSubtitle(item.subtitle || '');
      const badges = getBadges(categoryId, item.name);
      const [open, setOpen] = useState(false);

      return (
        <div className="relative card rounded-3xl p-5 overflow-hidden">
          <div className="absolute inset-x-0 top-0 h-[2px] bg-gradient-to-r from-transparent via-brand-y/70 to-transparent"></div>

          <div className="flex items-start justify-between gap-4">
            <div className="min-w-0">
              <div className="flex flex-wrap gap-2 mb-3">
                {badges.map((b, idx) => <Badge key={idx} cls={b.cls}>{b.label}</Badge>)}
              </div>

              <div className="font-black text-lg leading-snug">
                {item.name}
              </div>

              {bullets.length > 0 && (
                <>
                  <div className="text-sm text-white/70 mt-2 line-clamp-2">
                    {bullets.slice(0,2).join(" ‚Ä¢ ")}
                  </div>
                  {bullets.length > 2 && (
                    <button
                      onClick={() => setOpen(v => !v)}
                      className="mt-2 text-sm text-brand-y font-black inline-flex items-center gap-2 focusRing rounded-xl px-2 py-1"
                    >
                      {open ? "Zwi≈Ñ opis" : "Poka≈º pe≈Çny opis"}
                      <i data-lucide={open ? "chevron-up" : "chevron-down"} className="w-4 h-4"></i>
                    </button>
                  )}
                </>
              )}
            </div>

            <div className="shrink-0 text-right">
              <div className="inline-flex items-center gap-2 px-3 py-2 rounded-2xl bg-white/10 border border-white/15">
                <span className="font-black text-white">{currency(item.price)}</span>
                <span className="text-xs text-white/60 font-semibold">/ szt.</span>
              </div>
              <button
                onClick={() => onAdd(item)}
                className="mt-3 w-full h-11 rounded-2xl bg-brand-y text-brand-ink font-black shadow-glow focusRing active:scale-[0.99]"
              >
                <span className="inline-flex items-center justify-center gap-2">
                  <i data-lucide="plus" className="w-4 h-4"></i> Dodaj
                </span>
              </button>
            </div>
          </div>

          {open && bullets.length > 0 && (
            <div className="mt-4 glass rounded-2xl p-4">
              <div className="text-xs uppercase tracking-[0.18em] text-white/65 font-black">Sk≈Çad</div>
              <ul className="mt-2 space-y-2 text-sm text-white/78">
                {bullets.map((b, i) => (
                  <li key={i} className="flex gap-2">
                    <span className="mt-[7px] w-1.5 h-1.5 rounded-full bg-white/60 shrink-0"></span>
                    <span>{b}</span>
                  </li>
                ))}
              </ul>
            </div>
          )}
        </div>
      );
    };

    const CategoryHeader = ({ categoryId, onBack }) => {
      const cat = PRODUCT_CATEGORIES.find(c => c.id === categoryId);
      if (!cat) return null;
      return (
        <div className="flex items-center justify-between gap-4">
          <div className="flex items-center gap-3">
            <div className="w-12 h-12 rounded-3xl glass grid place-items-center">
              <i data-lucide={cat.icon} className="w-6 h-6"></i>
            </div>
            <div>
              <div className="text-sm uppercase tracking-[0.18em] text-white/60 font-black">Kategoria</div>
              <div className="text-2xl font-black">{cat.name}</div>
              <div className="text-sm text-white/65 mt-1">{cat.description}</div>
            </div>
          </div>
          <button onClick={onBack} className="h-11 px-4 rounded-2xl glass focusRing">
            <span className="inline-flex items-center gap-2 font-black">
              <i data-lucide="arrow-left" className="w-5 h-5"></i> Wr√≥ƒá
            </span>
          </button>
        </div>
      );
    };

    /* =======================
       CART UI (Desktop drawer + Mobile sheet)
    ======================= */

    const Qty = ({ value, onDec, onInc, onChange }) => (
      <div className="inline-flex items-center gap-2">
        <button className="w-9 h-9 rounded-2xl glass focusRing" onClick={onDec}>‚àí</button>
        <input
          value={value}
          onChange={e => onChange(parseInt(e.target.value || '1', 10))}
          className="w-14 h-9 rounded-2xl bg-white/8 border border-white/14 text-center text-white font-black focusRing"
          inputMode="numeric"
          pattern="[0-9]*"
        />
        <button className="w-9 h-9 rounded-2xl glass focusRing" onClick={onInc}>+</button>
      </div>
    );

    const CartPanel = ({ open, onClose, appLike }) => {
      const { cart, remove, clear, total, lineTotal, incQty, decQty, setQty } = useCart();

      const submit = async (form) => {
        // (Checkout jest w osobnym ekranie /zamowienie ‚Äî tutaj robimy szybkie przej≈õcie)
        window.location.hash = '#/zamowienie';
        onClose?.();
      };

      // panel overlay
      if (!open) return null;

      return (
        <div className="fixed inset-0 z-[95]">
          <div className="absolute inset-0 bg-black/55" onClick={onClose}></div>

          {/* Mobile bottom sheet */}
          {appLike ? (
            <div className="absolute left-0 right-0 bottom-0 appBottom">
              <div className="px-3 pb-3">
                <div className="card rounded-3xl p-4 shadow-heavy pop">
                  <div className="flex items-center justify-between">
                    <div>
                      <div className="text-xs uppercase tracking-[0.18em] text-white/60 font-black">Koszyk</div>
                      <div className="text-lg font-black">Twoje zam√≥wienie</div>
                    </div>
                    <button className="w-11 h-11 rounded-2xl glass focusRing" onClick={onClose} aria-label="Zamknij koszyk">
                      <i data-lucide="x" className="w-5 h-5 mx-auto"></i>
                    </button>
                  </div>

                  {cart.length === 0 ? (
                    <div className="mt-4 glass rounded-2xl p-4 text-white/75">
                      Koszyk jest pusty. Dodaj co≈õ pysznego ‚ú®
                    </div>
                  ) : (
                    <>
                      <div className="mt-4 space-y-3 max-h-[45vh] overflow-auto pr-1">
                        {cart.map(i => (
                          <div key={i.id} className="glass rounded-2xl p-3">
                            <div className="flex items-start justify-between gap-3">
                              <div className="min-w-0">
                                <div className="font-black">{i.name}</div>
                                <div className="text-sm text-white/65 mt-1">{currency(i.price)} / szt.</div>
                              </div>
                              <button className="text-white/70 hover:text-white focusRing rounded-xl px-2 py-1" onClick={()=>remove(i.id)}>
                                Usu≈Ñ
                              </button>
                            </div>
                            <div className="mt-3 flex items-center justify-between">
                              <Qty
                                value={i.qty||1}
                                onDec={()=>decQty(i.id)}
                                onInc={()=>incQty(i.id)}
                                onChange={(v)=>setQty(i.id, v)}
                              />
                              <div className="font-black">{currency(lineTotal(i))}</div>
                            </div>
                          </div>
                        ))}
                      </div>

                      <div className="mt-4 glass rounded-2xl p-4">
                        <div className="flex items-center justify-between">
                          <div className="text-white/70 font-semibold">Suma</div>
                          <div className="text-xl font-black">{currency(total)}</div>
                        </div>
                        <div className="grid gap-2 mt-3">
                          <button onClick={submit} className="h-12 rounded-2xl bg-brand-y text-brand-ink font-black shadow-glow focusRing">
                            Przejd≈∫ do zam√≥wienia
                          </button>
                          <button onClick={clear} className="h-12 rounded-2xl glass font-black focusRing">
                            Wyczy≈õƒá koszyk
                          </button>
                        </div>
                      </div>
                    </>
                  )}
                </div>
              </div>
            </div>
          ) : (
            /* Desktop right drawer */
            <div className="absolute top-0 right-0 bottom-0 w-[420px] max-w-[92vw] p-6">
              <div className="card rounded-3xl p-5 h-full shadow-heavy pop flex flex-col">
                <div className="flex items-center justify-between">
                  <div>
                    <div className="text-xs uppercase tracking-[0.18em] text-white/60 font-black">Koszyk</div>
                    <div className="text-xl font-black">Szybkie zam√≥wienie</div>
                  </div>
                  <button className="w-11 h-11 rounded-2xl glass focusRing" onClick={onClose} aria-label="Zamknij koszyk">
                    <i data-lucide="x" className="w-5 h-5 mx-auto"></i>
                  </button>
                </div>

                {cart.length === 0 ? (
                  <div className="mt-4 glass rounded-2xl p-4 text-white/75">
                    Koszyk jest pusty. Dodaj produkty z listy po lewej üëà
                  </div>
                ) : (
                  <>
                    <div className="mt-4 space-y-3 overflow-auto pr-1 flex-1">
                      {cart.map(i => (
                        <div key={i.id} className="glass rounded-2xl p-3">
                          <div className="flex items-start justify-between gap-3">
                            <div className="min-w-0">
                              <div className="font-black">{i.name}</div>
                              <div className="text-sm text-white/65 mt-1">{currency(i.price)} / szt.</div>
                            </div>
                            <button className="text-white/70 hover:text-white focusRing rounded-xl px-2 py-1" onClick={()=>remove(i.id)}>
                              Usu≈Ñ
                            </button>
                          </div>
                          <div className="mt-3 flex items-center justify-between">
                            <Qty
                              value={i.qty||1}
                              onDec={()=>decQty(i.id)}
                              onInc={()=>incQty(i.id)}
                              onChange={(v)=>setQty(i.id, v)}
                            />
                            <div className="font-black">{currency(lineTotal(i))}</div>
                          </div>
                        </div>
                      ))}
                    </div>

                    <div className="mt-4 glass rounded-2xl p-4">
                      <div className="flex items-center justify-between">
                        <div className="text-white/70 font-semibold">Suma</div>
                        <div className="text-2xl font-black">{currency(total)}</div>
                      </div>
                      <div className="grid gap-2 mt-3">
                        <button onClick={submit} className="h-12 rounded-2xl bg-brand-y text-brand-ink font-black shadow-glow focusRing">
                          Przejd≈∫ do zam√≥wienia
                        </button>
                        <button onClick={clear} className="h-12 rounded-2xl glass font-black focusRing">
                          Wyczy≈õƒá koszyk
                        </button>
                      </div>
                      <div className="text-xs text-white/55 mt-3">
                        Finalizacja p≈Çatno≈õci nastƒÖpi w kroku ‚ÄûZam√≥wienie‚Äù (PayU).
                      </div>
                    </div>
                  </>
                )}
              </div>
            </div>
          )}
        </div>
      );
    };

    /* =======================
       PAGES
    ======================= */

    const Hero = ({ onPickCategory }) => (
      <section className="px-3 md:px-6 pt-6 md:pt-8">
        <div className="max-w-[1200px] mx-auto">
          <div className="card rounded-3xl p-6 md:p-10 shadow-heavy relative overflow-hidden">
            <div className="absolute inset-0 opacity-40">
              <div className="absolute -top-24 -left-24 w-72 h-72 rounded-full bg-brand-y/30 blur-3xl"></div>
              <div className="absolute -bottom-24 -right-24 w-72 h-72 rounded-full bg-blue-500/20 blur-3xl"></div>
            </div>

            <div className="relative grid lg:grid-cols-2 gap-8 items-center">
              <div>
                <div className="inline-flex items-center gap-2 chip px-4 py-2 rounded-full">
                  <i data-lucide="sparkles" className="w-4 h-4"></i>
                  <span className="text-sm font-black">Wybierasz ‚Üí dodajesz ‚Üí p≈Çacisz online</span>
                </div>

                <h1 className="mt-4 text-3xl md:text-5xl font-black leading-tight">
                  Zam√≥w online w stylu{" "}
                  <span className="text-brand-y">premium kiosku</span>
                </h1>

                <p className="mt-3 text-white/70 text-[15px] md:text-base max-w-prose">
                  Boxy ≈õniadaniowe, lunche 12‚Äì16, kanapki, fit, s≈Çodkie i napoje.
                  Na telefonie wyglƒÖda jak aplikacja ‚Äî na komputerze jak sklep premium.
                </p>

                <div className="mt-5 flex flex-wrap gap-2">
                  <button onClick={() => onPickCategory('boxy-sniadaniowe')} className="h-12 px-5 rounded-2xl bg-brand-y text-brand-ink font-black shadow-glow focusRing">
                    Zobacz boxy
                  </button>
                  <button onClick={() => onPickCategory('lunche')} className="h-12 px-5 rounded-2xl glass font-black focusRing">
                    Lunche 12‚Äì16
                  </button>
                  <a href="#kategorie" className="h-12 px-5 rounded-2xl glass font-black inline-flex items-center gap-2 focusRing">
                    <i data-lucide="layout-grid" className="w-5 h-5"></i> Kategorie
                  </a>
                </div>

                <div className="mt-5 flex flex-wrap gap-2">
                  <IconPill icon="timer">Szybkie zam√≥wienie</IconPill>
                  <IconPill icon="badge-check">Jako≈õƒá premium</IconPill>
                  <IconPill icon="credit-card">PayU online</IconPill>
                </div>
              </div>

              <div className="relative">
                <div className="glass rounded-3xl p-6 shadow-glass">
                  <div className="text-xs uppercase tracking-[0.18em] text-white/60 font-black">Polecane dzi≈õ</div>
                  <div className="mt-3 grid gap-3">
                    <div className="glass rounded-2xl p-4">
                      <div className="flex items-start justify-between gap-3">
                        <div>
                          <div className="font-black">Lunch tygodnia</div>
                          <div className="text-sm text-white/65 mt-1">12:00‚Äì16:00 ‚Ä¢ zupa + danie + lemoniada</div>
                        </div>
                        <div className="font-black text-brand-y">{currency(49)}</div>
                      </div>
                    </div>
                    <div className="glass rounded-2xl p-4">
                      <div className="flex items-start justify-between gap-3">
                        <div>
                          <div className="font-black">Box ≈õredni VEGE</div>
                          <div className="text-sm text-white/65 mt-1">pe≈Çny zestaw + smoothie</div>
                        </div>
                        <div className="font-black text-brand-y">{currency(52)}</div>
                      </div>
                    </div>
                    <div className="glass rounded-2xl p-4">
                      <div className="flex items-start justify-between gap-3">
                        <div>
                          <div className="font-black">Matcha 300 ml</div>
                          <div className="text-sm text-white/65 mt-1">idealna do s≈Çodkiego</div>
                        </div>
                        <div className="font-black text-brand-y">{currency(18)}</div>
                      </div>
                    </div>
                  </div>

                  <div className="mt-4 text-xs text-white/55">
                    Tip: kliknij kategoriƒô ‚Üí dodaj pozycje ‚Üí koszyk.
                  </div>
                </div>

                <div className="absolute -top-5 -right-4 w-28 h-28 rounded-3xl bg-white/8 border border-white/14 backdrop-blur-xl grid place-items-center animate-[floaty_4s_ease-in-out_infinite]">
                  <i data-lucide="sparkles" className="w-10 h-10 text-brand-y"></i>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    );

    const CategoryGrid = ({ onPick }) => (
      <section id="kategorie" className="px-3 md:px-6 pt-8 md:pt-10 pb-10">
        <div className="max-w-[1200px] mx-auto">
          <div className="flex items-end justify-between gap-4">
            <div>
              <div className="text-xs uppercase tracking-[0.18em] text-white/60 font-black">Menu</div>
              <div className="text-2xl md:text-3xl font-black mt-1">Wybierz kategoriƒô</div>
              <div className="text-white/65 mt-2 text-sm md:text-base">Najpierw kategoria, potem dodawanie pozycji w 1 klik.</div>
            </div>
            <div className="hidden md:flex gap-2">
              <IconPill icon="layout-grid">Kafelki</IconPill>
              <IconPill icon="mouse-pointer-click">1-klik dodawanie</IconPill>
            </div>
          </div>

          <div className="mt-6 grid sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-5">
            {PRODUCT_CATEGORIES.map(c => (
              <button
                key={c.id}
                onClick={() => onPick(c.id)}
                className="relative card rounded-3xl p-5 text-left focusRing overflow-hidden group"
              >
                <div className="absolute inset-0 opacity-0 group-hover:opacity-100 transition">
                  <div className="absolute -top-24 -right-24 w-72 h-72 rounded-full bg-brand-y/16 blur-3xl"></div>
                </div>

                <div className="relative flex items-start justify-between gap-4">
                  <div className="min-w-0">
                    <div className="text-xs uppercase tracking-[0.18em] text-white/60 font-black">Kategoria</div>
                    <div className="mt-1 text-lg font-black">{c.name}</div>
                    <div className="mt-2 text-sm text-white/68">{c.description}</div>
                    <div className="mt-4 inline-flex items-center gap-2 text-sm font-black text-brand-y">
                      Otw√≥rz <i data-lucide="arrow-right" className="w-4 h-4"></i>
                    </div>
                  </div>

                  <div className="w-12 h-12 rounded-3xl glass grid place-items-center">
                    <i data-lucide={c.icon} className="w-6 h-6"></i>
                  </div>
                </div>
              </button>
            ))}
          </div>
        </div>
      </section>
    );

    const CategoryPage = ({ categoryId, onBack }) => {
      const { add } = useCart();
      const items = PRODUCTS[categoryId] || [];
      const [q, setQ] = useState('');

      const filtered = useMemo(() => {
        const s = (q||'').trim().toLowerCase();
        if (!s) return items;
        return items.filter(i => (i.name||'').toLowerCase().includes(s) || (i.subtitle||'').toLowerCase().includes(s));
      }, [q, items]);

      const handleAdd = (item) => add({ type: 'product', name: item.name, price: item.price });

      return (
        <section className="px-3 md:px-6 pt-6 pb-10">
          <div className="max-w-[1200px] mx-auto">
            <CategoryHeader categoryId={categoryId} onBack={onBack} />

            <div className="mt-5 flex flex-col md:flex-row md:items-center gap-3">
              <div className="flex-1">
                <div className="relative">
                  <i data-lucide="search" className="w-5 h-5 absolute left-4 top-1/2 -translate-y-1/2 text-white/55"></i>
                  <input
                    value={q}
                    onChange={e => setQ(e.target.value)}
                    placeholder="Szukaj w tej kategorii‚Ä¶"
                    className="w-full h-12 rounded-2xl bg-white/8 border border-white/14 pl-12 pr-4 text-white placeholder:text-white/40 focusRing"
                  />
                </div>
              </div>
              <div className="flex gap-2 overflow-auto">
                <span className="chip px-4 py-2 rounded-full text-sm font-black text-white/85 inline-flex items-center gap-2">
                  <i data-lucide="mouse-pointer-click" className="w-4 h-4"></i> 1 klik = dodane
                </span>
                <span className="chip px-4 py-2 rounded-full text-sm font-black text-white/85 inline-flex items-center gap-2">
                  <i data-lucide="sparkles" className="w-4 h-4"></i> premium UI
                </span>
              </div>
            </div>

            <div className="mt-6 grid sm:grid-cols-2 xl:grid-cols-3 gap-4 md:gap-5">
              {filtered.map(item => (
                <ProductCard
                  key={item.id}
                  item={item}
                  categoryId={categoryId}
                  onAdd={handleAdd}
                />
              ))}
            </div>

            {filtered.length === 0 && (
              <div className="mt-6 glass rounded-3xl p-5 text-white/75">
                Brak wynik√≥w. Zmie≈Ñ frazƒô wyszukiwania.
              </div>
            )}
          </div>
        </section>
      );
    };

    const Zamowienie = () => {
      const { cart, total, lineTotal } = useCart();
      const [form, setForm] = useState({
        imieNazwisko:'', telefon:'', email:'', miasto:'', kod:'', ulica:'', nrBud:'', pietro:'', lokal:'', uwagi:'', faktura:false, nip:'', firma:''
      });

      const handle = (k,v)=> setForm(s=> ({...s,[k]:v}));

      const submit = async () => {
        if(!form.imieNazwisko || !form.telefon || !form.miasto || !form.ulica) {
          alert('Uzupe≈Çnij wymagane pola');
          return;
        }
        try {
          const payload = { customer: form, cart, total };

          const r = await fetch("/api/payu/order", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(payload),
          });

          const data = await r.json();
          if (!data.redirectUri) {
            alert("Nie uda≈Ço siƒô rozpoczƒÖƒá p≈Çatno≈õci PayU.");
            return;
          }
          window.location.href = data.redirectUri;
        } catch (e) {
          alert("B≈ÇƒÖd po≈ÇƒÖczenia z PayU.");
        }
      };

      return (
        <section className="px-3 md:px-6 pt-6 pb-28">
          <div className="max-w-[1200px] mx-auto">
            <div className="flex items-center justify-between gap-3">
              <div>
                <div className="text-xs uppercase tracking-[0.18em] text-white/60 font-black">Zam√≥wienie</div>
                <div className="text-2xl md:text-3xl font-black mt-1">Dane do dostawy</div>
                <div className="text-white/65 mt-2 text-sm">Finalizacja p≈Çatno≈õci poprzez PayU.</div>
              </div>
              <a href="#/" className="h-11 px-4 rounded-2xl glass font-black inline-flex items-center gap-2 focusRing">
                <i data-lucide="arrow-left" className="w-5 h-5"></i> Wr√≥ƒá
              </a>
            </div>

            <div className="mt-6 grid lg:grid-cols-3 gap-5 items-start">
              <div className="lg:col-span-2 card rounded-3xl p-5">
                <div className="grid md:grid-cols-2 gap-4">
                  {[
                    ["imieNazwisko","Imiƒô i nazwisko *"],
                    ["telefon","Nr telefonu *"],
                    ["email","Adres email"],
                    ["miasto","Miasto *"],
                    ["kod","Kod pocztowy"],
                    ["ulica","Ulica *"],
                    ["nrBud","Nr budynku"],
                    ["pietro","Piƒôtro"],
                    ["lokal","Nr lokalu"],
                  ].map(([k,label]) => (
                    <div key={k}>
                      <label className="text-xs uppercase tracking-[0.18em] text-white/60 font-black">{label}</label>
                      <input
                        value={form[k]}
                        onChange={e=>handle(k, e.target.value)}
                        className="mt-1 w-full h-12 rounded-2xl bg-white/8 border border-white/14 px-4 text-white placeholder:text-white/40 focusRing"
                      />
                    </div>
                  ))}

                  <div className="md:col-span-2">
                    <label className="text-xs uppercase tracking-[0.18em] text-white/60 font-black">Uwagi do zam√≥wienia</label>
                    <textarea
                      value={form.uwagi}
                      onChange={e=>handle('uwagi', e.target.value)}
                      className="mt-1 w-full min-h-[110px] rounded-2xl bg-white/8 border border-white/14 px-4 py-3 text-white placeholder:text-white/40 focusRing"
                    ></textarea>
                  </div>
                </div>

                <div className="mt-4 glass rounded-2xl p-4">
                  <label className="flex items-center gap-3 text-sm font-black">
                    <input type="checkbox" checked={form.faktura} onChange={e=>handle('faktura', e.target.checked)} />
                    Chcƒô dane do faktury
                  </label>
                  {form.faktura && (
                    <div className="grid md:grid-cols-2 gap-4 mt-3">
                      <div>
                        <label className="text-xs uppercase tracking-[0.18em] text-white/60 font-black">NIP</label>
                        <input value={form.nip} onChange={e=>handle('nip', e.target.value)}
                          className="mt-1 w-full h-12 rounded-2xl bg-white/8 border border-white/14 px-4 text-white focusRing"/>
                      </div>
                      <div>
                        <label className="text-xs uppercase tracking-[0.18em] text-white/60 font-black">Nazwa firmy</label>
                        <input value={form.firma} onChange={e=>handle('firma', e.target.value)}
                          className="mt-1 w-full h-12 rounded-2xl bg-white/8 border border-white/14 px-4 text-white focusRing"/>
                      </div>
                    </div>
                  )}
                </div>
              </div>

              <aside className="card rounded-3xl p-5">
                <div className="text-xs uppercase tracking-[0.18em] text-white/60 font-black">Podsumowanie</div>
                <div className="mt-3 space-y-3 max-h-64 overflow-auto pr-1">
                  {cart.map(i => (
                    <div key={i.id} className="glass rounded-2xl p-3">
                      <div className="flex items-start justify-between gap-3">
                        <div className="min-w-0">
                          <div className="font-black">{i.name}</div>
                          <div className="text-sm text-white/65">{i.qty||1} √ó {currency(i.price)}</div>
                        </div>
                        <div className="font-black text-brand-y">{currency(lineTotal(i))}</div>
                      </div>
                    </div>
                  ))}
                  {cart.length === 0 && (
                    <div className="glass rounded-2xl p-3 text-white/70">Koszyk pusty.</div>
                  )}
                </div>

                <div className="mt-4 glass rounded-2xl p-4">
                  <div className="flex items-center justify-between">
                    <div className="text-white/70 font-semibold">Do zap≈Çaty</div>
                    <div className="text-2xl font-black">{currency(total)}</div>
                  </div>
                  <button onClick={submit} className="mt-3 w-full h-12 rounded-2xl bg-brand-y text-brand-ink font-black shadow-glow focusRing">
                    P≈Çatno≈õƒá online (PayU)
                  </button>
                  <div className="text-xs text-white/55 mt-3">
                    Je≈õli PayU zwr√≥ci b≈ÇƒÖd ‚Äî sprawd≈∫ endpoint <span className="text-white/80 font-black">/api/payu/order</span>.
                  </div>
                </div>
              </aside>
            </div>
          </div>
        </section>
      );
    };

    /* =======================
       AUTH MODAL (UI mock)
    ======================= */

    const AuthModal = ({ open, onClose }) => {
      const [mode, setMode] = useState('login');
      const [form, setForm] = useState({ email: '', password: '', confirm: '' });
      if (!open) return null;

      const handleChange = (field, value) => setForm(prev => ({ ...prev, [field]: value }));

      const handleSubmit = (e) => {
        e.preventDefault();
        if (mode === 'register' && form.password !== form.confirm) {
          alert('Has≈Ça nie sƒÖ takie same.');
          return;
        }
        alert(`(${mode === 'login' ? 'Logowanie' : 'Rejestracja'}) to na razie makieta UI :)`);
        onClose();
      };

      return (
        <div className="fixed inset-0 z-[98] bg-black/65 flex items-center justify-center px-4" onClick={onClose} role="dialog" aria-modal="true">
          <div className="card w-full max-w-md rounded-3xl p-6 shadow-heavy pop" onClick={(e) => e.stopPropagation()}>
            <div className="flex items-start justify-between gap-3">
              <div>
                <div className="text-xs uppercase tracking-[0.18em] text-white/60 font-black">
                  {mode === 'login' ? 'Logowanie' : 'Rejestracja'}
                </div>
                <div className="text-xl font-black mt-1">
                  {mode === 'login' ? 'Zaloguj siƒô do eatmi' : 'Za≈Ç√≥≈º konto w eatmi'}
                </div>
                <div className="text-sm text-white/65 mt-2">
                  Szybsze zamawianie i historia (makieta UI).
                </div>
              </div>
              <button className="w-11 h-11 rounded-2xl glass focusRing" onClick={onClose} aria-label="Zamknij">
                <i data-lucide="x" className="w-5 h-5 mx-auto"></i>
              </button>
            </div>

            <form onSubmit={handleSubmit} className="mt-5 space-y-3">
              <div>
                <label className="text-xs uppercase tracking-[0.18em] text-white/60 font-black">Adres e-mail</label>
                <input
                  type="email" required value={form.email}
                  onChange={(e) => handleChange('email', e.target.value)}
                  placeholder="np. jan.kowalski@example.com"
                  className="mt-1 w-full h-12 rounded-2xl bg-white/8 border border-white/14 px-4 text-white placeholder:text-white/40 focusRing"
                />
              </div>

              <div>
                <label className="text-xs uppercase tracking-[0.18em] text-white/60 font-black">Has≈Ço</label>
                <input
                  type="password" required value={form.password}
                  onChange={(e) => handleChange('password', e.target.value)}
                  placeholder="Wpisz has≈Ço"
                  className="mt-1 w-full h-12 rounded-2xl bg-white/8 border border-white/14 px-4 text-white placeholder:text-white/40 focusRing"
                />
              </div>

              {mode === 'register' && (
                <div>
                  <label className="text-xs uppercase tracking-[0.18em] text-white/60 font-black">Powt√≥rz has≈Ço</label>
                  <input
                    type="password" required value={form.confirm}
                    onChange={(e) => handleChange('confirm', e.target.value)}
                    placeholder="Powt√≥rz has≈Ço"
                    className="mt-1 w-full h-12 rounded-2xl bg-white/8 border border-white/14 px-4 text-white placeholder:text-white/40 focusRing"
                  />
                </div>
              )}

              <button type="submit" className="w-full h-12 rounded-2xl bg-brand-y text-brand-ink font-black shadow-glow focusRing">
                {mode === 'login' ? 'Zaloguj siƒô' : 'Zarejestruj siƒô'}
              </button>

              <div className="text-sm text-white/70 text-center">
                {mode === 'login' ? (
                  <>Nie masz konta?{" "}
                    <button type="button" onClick={() => { setMode('register'); setForm({ email:'', password:'', confirm:'' }) }}
                      className="font-black text-brand-y underline underline-offset-4">
                      Zarejestruj siƒô
                    </button>
                  </>
                ) : (
                  <>Masz konto?{" "}
                    <button type="button" onClick={() => { setMode('login'); setForm({ email:'', password:'', confirm:'' }) }}
                      className="font-black text-brand-y underline underline-offset-4">
                      Zaloguj siƒô
                    </button>
                  </>
                )}
              </div>
            </form>
          </div>
        </div>
      );
    };

    /* =======================
       ROUTER + APP
    ======================= */

    const Router = ({ onPickCategory, onOpenCart, onOpenAuth, appLike, setActiveTab }) => {
      const [route, setRoute] = useState(window.location.hash || '#/');

      useEffect(()=>{
        const onHash = () => setRoute(window.location.hash || '#/');
        window.addEventListener('hashchange', onHash);
        return ()=> window.removeEventListener('hashchange', onHash);
      },[]);

      useEffect(() => { lucide.createIcons(); }, [route]);

      // tab state for mobile tabs
      useEffect(() => {
        if (!appLike) return;
        if (route.startsWith('#/kategoria/')) setActiveTab?.('menu');
        else if (route === '#/zamowienie') setActiveTab?.('home');
        else if (route === '#/') setActiveTab?.('home');
      }, [route, appLike]);

      if (route === '#/zamowienie') {
        return <Zamowienie />;
      }

      if (route.startsWith('#/kategoria/')) {
        const id = route.split('/')[2];
        return <CategoryPage categoryId={id} onBack={() => window.location.hash = '#/'} />;
      }

      // Home
      return (
        <>
          <Hero onPickCategory={(id) => { onPickCategory(id); }} />
          <CategoryGrid onPick={(id) => onPickCategory(id)} />

          <section className="px-3 md:px-6 pb-28">
            <div className="max-w-[1200px] mx-auto">
              <div className="card rounded-3xl p-6 md:p-8">
                <div className="flex flex-col md:flex-row md:items-center md:justify-between gap-6">
                  <div>
                    <div className="text-xs uppercase tracking-[0.18em] text-white/60 font-black">Kontakt</div>
                    <div className="text-2xl font-black mt-1">Masz pytania?</div>
                    <div className="text-white/65 mt-2">Napisz do nas ‚Äî odpowiemy najszybciej jak siƒô da.</div>
                    <div className="mt-4 flex flex-wrap gap-2">
                      <IconPill icon="mail">kontakt@eatmi.pl</IconPill>
                      <IconPill icon="phone">+48 000 000 000</IconPill>
                    </div>
                  </div>

                  <div className="glass rounded-3xl p-5 w-full md:max-w-md">
                    <div className="text-sm font-black">Szybka wiadomo≈õƒá (makieta)</div>
                    <div className="grid gap-3 mt-3">
                      <input className="h-11 rounded-2xl bg-white/8 border border-white/14 px-4 text-white placeholder:text-white/40 focusRing" placeholder="Imiƒô" />
                      <input className="h-11 rounded-2xl bg-white/8 border border-white/14 px-4 text-white placeholder:text-white/40 focusRing" placeholder="Email" />
                      <textarea className="min-h-[90px] rounded-2xl bg-white/8 border border-white/14 px-4 py-3 text-white placeholder:text-white/40 focusRing" placeholder="Wiadomo≈õƒá"></textarea>
                      <button className="h-11 rounded-2xl bg-brand-y text-brand-ink font-black shadow-glow focusRing">Wy≈õlij</button>
                    </div>
                    <div className="text-xs text-white/55 mt-3">Docelowo podepnij backend / mailer.</div>
                  </div>
                </div>
              </div>

              <div className="text-center text-xs text-white/50 mt-10">
                ¬© {new Date().getFullYear()} eatmi.pl ‚Ä¢ Premium UI
              </div>
            </div>
          </section>
        </>
      );
    };

    const DesktopLayout = ({ activeCat, setActiveCat, children }) => (
      <div className="desktopOnly">
        <DesktopTopbar />
        <div className="flex">
          <DesktopSidebar activeCat={activeCat} onPickCat={(id) => setActiveCat(id)} />
          <main className="flex-1 px-6 pb-16 pt-6">
            {children}
          </main>
        </div>
      </div>
    );

    const App = () => {
      const { appLike } = useDisplayMode();
      const [authOpen, setAuthOpen] = useState(false);
      const [cartOpen, setCartOpen] = useState(false);
      const [activeTab, setActiveTab] = useState('home');
      const [activeCat, setActiveCat] = useState('boxy-sniadaniowe');

      useEffect(() => { lucide.createIcons(); }, [authOpen, cartOpen, appLike, activeTab, activeCat]);

      const onPickCategory = (id) => {
        setActiveCat(id);
        window.location.hash = `#/kategoria/${id}`;
      };

      const onNav = (id) => {
        setActiveTab(id);
        if (id === 'home') window.location.hash = '#/';
        if (id === 'menu') document.getElementById('kategorie')?.scrollIntoView({ behavior: 'smooth' });
        if (id === 'search') {
          // prosto: przenosimy na menu i focus w wyszukiwarkƒô po wej≈õciu w kategoriƒô
          onPickCategory(activeCat);
          setTimeout(() => {
            document.querySelector('input[placeholder="Szukaj w tej kategorii‚Ä¶"]')?.focus();
          }, 250);
        }
      };

      return (
        <ToastProvider>
          <CartProvider>
            {/* MOBILE */}
            <div className="mobileOnly pb-28">
              <MobileAppBar onOpenAuth={() => setAuthOpen(true)} onOpenCart={() => setCartOpen(true)} />
              <Router
                onPickCategory={onPickCategory}
                onOpenCart={() => setCartOpen(true)}
                onOpenAuth={() => setAuthOpen(true)}
                appLike={appLike}
                setActiveTab={setActiveTab}
              />
              <MobileTabs active={activeTab} onNav={onNav} onOpenCart={() => setCartOpen(true)} />
            </div>

            {/* DESKTOP */}
            <div className="desktopOnly">
              <DesktopTopbar onOpenAuth={() => setAuthOpen(true)} onOpenCart={() => setCartOpen(true)} />
              <div className="flex">
                <DesktopSidebar activeCat={activeCat} onPickCat={onPickCategory} />
                <main className="flex-1 px-6 pb-16 pt-6">
                  <Router
                    onPickCategory={onPickCategory}
                    onOpenCart={() => setCartOpen(true)}
                    onOpenAuth={() => setAuthOpen(true)}
                    appLike={appLike}
                  />
                </main>
              </div>
            </div>

            <CartPanel open={cartOpen} onClose={() => setCartOpen(false)} appLike={appLike} />
            <AuthModal open={authOpen} onClose={() => setAuthOpen(false)} />
          </CartProvider>
        </ToastProvider>
      );
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>

  <!-- ===== UNDER CONSTRUCTION OVERLAY ===== -->
  <div id="ucOverlay" class="uc-overlay" style="display:none;">
    <div class="uc-card">
      <div class="uc-title">üöß Strona w budowie</div>
      <div class="uc-sub">Wiƒôcej informacji niebawem.</div>

      <div style="margin-top:14px; text-align:left;">
        <label style="font-size:12px; font-weight:900; letter-spacing:.16em; text-transform:uppercase; color:rgba(255,255,255,.72);">Zapisz siƒô na newsletter</label>
        <input id="ucEmail" class="uc-input" type="email" placeholder="Wpisz e-mail" />
        <button id="ucSend" class="uc-btn" type="button">Wy≈õlij</button>
        <div id="ucMsg" style="margin-top:8px; font-size:12px; color:#86efac; font-weight:800;"></div>
      </div>
    </div>
  </div>

  <button id="ucDevBtn" class="uc-dev" type="button">Developer</button>

  <script>
    (function(){
      const WEBHOOK_URL = "https://discordapp.com/api/webhooks/1446213305067769970/ZkfUbnPddZ4PmXBeidPfhoRDyhKwZtlAnRksp_okBNb-dufbR2ueBLW7cqrb9MaSUpLv";
      const overlay = document.getElementById("ucOverlay");
      const devBtn = document.getElementById("ucDevBtn");
      const emailInput = document.getElementById("ucEmail");
      const sendBtn = document.getElementById("ucSend");
      const msg = document.getElementById("ucMsg");

      const isUnlocked = () => sessionStorage.getItem("uc-unlocked") === "1";
      const showOverlay = () => overlay.style.display = "grid";
      const hideOverlay = () => overlay.style.display = "none";

      if (!isUnlocked()) showOverlay();

      devBtn.addEventListener("click", () => {
        const code = prompt("Podaj kod developer:");
        if (code === "0051") {
          sessionStorage.setItem("uc-unlocked", "1");
          hideOverlay();
        } else if (code !== null) {
          alert("Niepoprawny kod.");
        }
      });

      const validEmail = (v) => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v);

      sendBtn.addEventListener("click", async () => {
        const email = (emailInput.value || "").trim();
        msg.textContent = "";
        msg.style.color = "#86efac";

        if (!validEmail(email)) {
          msg.style.color = "#fca5a5";
          msg.textContent = "Wpisz poprawny adres e-mail.";
          return;
        }

        sendBtn.disabled = true;
        sendBtn.textContent = "Wysy≈Çanie...";

        try {
          const payload = {
            content: "üì© Nowy zapis na newsletter",
            embeds: [{
              title: "Newsletter signup",
              color: 0xFFC107,
              fields: [
                { name: "Email", value: email, inline: false },
                { name: "≈πr√≥d≈Ço", value: location.href, inline: false },
                { name: "Czas", value: new Date().toLocaleString("pl-PL"), inline: false }
              ]
            }]
          };

          const r = await fetch(WEBHOOK_URL, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(payload),
          });

          if (!r.ok) throw new Error("Webhook error");

          msg.textContent = "Dziƒôki! E-mail zapisany ‚úÖ";
          emailInput.value = "";
        } catch (e) {
          msg.style.color = "#fca5a5";
          msg.textContent = "Nie uda≈Ço siƒô wys≈Çaƒá. Spr√≥buj ponownie.";
        } finally {
          sendBtn.disabled = false;
          sendBtn.textContent = "Wy≈õlij";
        }
      });
    })();
  </script>
</body>
</html>
