<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>eatmi.pl — Zamów online</title>
  <meta name="description" content="eatmi.pl — Boxy śniadaniowe, lunche, kanapki, zdrowe, słodkie i napoje." />
  <link rel="icon" type="image/png" href="favicon.png">
  <link rel="manifest" href="/manifest.webmanifest">

  <script>
    tailwind = window.tailwind || {};
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            brand: {
              yellow: '#FFC107',
              yellow2: '#FFB300',
              ink: '#0F172A',
              muted: '#475569',
              line: '#E2E8F0'
            }
          }
        }
      }
    };
  </script>
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- React 18 + ReactDOM 18 -->
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>

  <!-- Babel for JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Lucide icons -->
  <script src="https://unpkg.com/lucide@latest"></script>

  <style>
    :root{
      --y:#FFC107; --y2:#FFB300;
      --ink:#0F172A; --muted:#475569; --line:#E2E8F0;
    }
    html,body{ background:#fff; color:var(--ink); }

    /* Flat, prosto */
    .card{ background:#fff; border:1px solid var(--line); border-radius:16px; }
    .card:hover{ border-color: rgba(255,193,7,.65); }
    .focusY:focus{ outline:none; box-shadow:0 0 0 3px rgba(255,193,7,.28); border-color: rgba(255,193,7,.75); }

    .btnY{ background:var(--y); color:#111827; font-weight:800; border-radius:14px; }
    .btnY:hover{ background:var(--y2); }
    .btnO{ background:#fff; border:1px solid rgba(255,193,7,.55); font-weight:800; border-radius:14px; }
    .btnO:hover{ border-color: rgba(255,193,7,.85); }

    .pillPrice{ background:rgba(255,193,7,.18); border:1px solid rgba(255,193,7,.55); border-radius:999px; padding:.35rem .7rem; font-weight:900; }
    .toastIn{ animation: toastIn .16s ease-out; }
    @keyframes toastIn{ from{ transform:translateY(8px); opacity:0 } to{ transform:translateY(0); opacity:1 } }
  </style>
</head>

<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useMemo } = React;

    /* =======================
       MENU
    ======================= */

    const PRODUCT_CATEGORIES = [
      { id: 'boxy-sniadaniowe', name: 'Boxy śniadaniowe', icon: 'package-open' },
      { id: 'lunche', name: 'Lunche', icon: 'utensils-crossed' },
      { id: 'kanapki', name: 'Kanapki', icon: 'sandwich' },
      { id: 'zdrowe', name: 'Zdrowe', icon: 'leaf' },
      { id: 'slodkie', name: 'Słodkie', icon: 'ice-cream' },
      { id: 'napoje', name: 'Napoje', icon: 'cup-soda' },
    ];

    const BREAKFAST_BOXES = [
      { id:'bs-small-1', name:'Box śniadaniowy mały nr 1', price: 38, subtitle:'Kanapka z jajecznicą i bekonem, majonez sriracha • Domowa granola z jogurtem greckim, owocami i miodem • Sok pomarańczowy 250 ml' },
      { id:'bs-small-2', name:'Box śniadaniowy mały nr 2', price: 40, subtitle:'Buritto z jajecznicą i chorizo • Sałatka koreańska z kurczakiem w panko, warzywami i sezamem • Sok pomarańczowy 250 ml' },
      { id:'bs-small-3', name:'Box śniadaniowy mały nr 3', price: 42, subtitle:'Kanapka z rostbefem, jajkiem poche, sosem musztardowo-chrzanowym i oliwą truflową • Sałatka Cezar z kurczakiem, bekonem, sałatą rzymską i grzankami • Sok pomarańczowy 250 ml' },
      { id:'bs-small-vege', name:'Box śniadaniowy mały VEGE', price: 38, subtitle:'Kanapka z jajecznicą i awokado, majonez sriracha • Sałatka z carpaccio z buraka z kozim serem i orzechami pekan, mix sałat, pomarańczowy dressing z oliwą • Sok pomarańczowy 250 ml' },

      { id:'bs-med-1', name:'Box śniadaniowy średni nr 1', price: 52, subtitle:'Kanapka z jajecznicą i bekonem, majonez sriracha • Domowa granola z jogurtem greckim, owocami i miodem • Tost francuski z owocami i miodem • Sok pomarańczowy 250 ml' },
      { id:'bs-med-2', name:'Box śniadaniowy średni nr 2', price: 54, subtitle:'Buritto z jajecznicą i chorizo • Sałatka koreańska z kurczakiem w panko, warzywami i sezamem • Pancakes (2 szt.) z Nutellą i owocami • Sok pomarańczowy 250 ml' },
      { id:'bs-med-3', name:'Box śniadaniowy średni nr 3', price: 56, subtitle:'Kanapka z rostbefem, jajkiem poche, sosem musztardowo-chrzanowym i oliwą truflową • Sałatka Cezar z kurczakiem, bekonem, sałatą rzymską i grzankami • Deser czekoladowy z owocami i kruszonką • Sok pomarańczowy 250 ml' },
      { id:'bs-med-vege', name:'Box śniadaniowy średni VEGE', price: 52, subtitle:'Kanapka z jajecznicą i awokado, majonez sriracha • Sałatka z carpaccio z buraka z kozim serem i orzechami pekan, mix sałat, pomarańczowy dressing z oliwą • Smoothie Mango Lassi z miodem • Sok pomarańczowy 250 ml' },

      { id:'bs-big-1', name:'Box śniadaniowy duży nr 1', price: 80, subtitle:'Kanapka z jajecznicą i bekonem, majonez sriracha • Club sandwich z kurczakiem i bekonem, majonez, sałata, pomidor • Domowa granola z jogurtem greckim, owocami i miodem • Sałatka Cezar z kurczakiem, bekonem, sałatą rzymską i grzankami • Tost francuski z owocami i miodem • Sok pomarańczowy 250 ml' },
      { id:'bs-big-2', name:'Box śniadaniowy duży nr 2', price: 82, subtitle:'Buritto z jajecznicą i chorizo • Kanapka z jajecznicą i bekonem, majonez sriracha • Sałatka koreańska z kurczakiem w panko, warzywa i sezamem • Domowa granola z jogurtem greckim, owocami i miodem • Pancakes (2 szt.) z Nutellą i owocami • Sok pomarańczowy 250 ml' },
      { id:'bs-big-3', name:'Box śniadaniowy duży nr 3', price: 84, subtitle:'Kanapka z rostbefem, jajkiem poche, sosem musztardowo-chrzanowym i oliwą truflową • Kanapka z jajecznicą i bekonem, majonez sriracha • Sałatka Cezar z kurczakiem, bekonem, sałatą rzymską i grzankami • Domowa granola z jogurtem greckim, owocami i miodem • Deser czekoladowy z owocami i kruszonką • Sok pomarańczowy 250 ml' },
      { id:'bs-big-vege', name:'Box śniadaniowy duży VEGE', price: 80, subtitle:'Kanapka z jajecznicą i awokado, majonez sriracha • Vege club sandwich z camembert i awokado, majonez, sałata, pomidor • Sałatka z carpaccio z buraka z kozim serem i orzechami pekan, mix sałat, pomarańczowy dressing z oliwą • Domowa granola z jogurtem greckim, owocami i miodem • Smoothie Mango Lassi z miodem • Sok pomarańczowy 250 ml' },
    ];

    const LUNCHES = [
      { id:'lunch-week', name:'Lunch tygodnia', price: 49, subtitle:'Dostępny 12:00–16:00 • Zupa krem z pieczonych buraków 200 ml • Corn Flake Chicken: panierowana w płatkach kukurydzianych pierś z kurczaka z ziemniaczanym puree i coleslawem • Domowa lemoniada 250 ml' },
      { id:'lunch-month', name:'Lunch miesiąca', price: 59, subtitle:'Dostępny 12:00–16:00 • Zupa krem z pieczonych buraków 200 ml • Kurczak Supreme: pieczona pierś z kurczaka z ziemniaczanym puree, warzywami i sosem demi glace • Domowa lemoniada 250 ml' },
      { id:'lunch-vege', name:'Lunch VEGE', price: 49, subtitle:'Dostępny 12:00–16:00 • Zupa krem z pieczonych buraków 200 ml • Tagliatelle z warzywami, oliwą z oliwek i pastą truflową • Domowa lemoniada 250 ml' },
    ];

    const SANDWICHES = [
      { id:'k-jajecznica-bekon', name:'Maślane pieczywo z jajecznicą, bekonem i majonezem sriracha', price: 17 },
      { id:'k-club-kurczak', name:'Club sandwich z grillowanym kurczakiem, chrupiący bekon, majonez, sałata i pomidor', price: 17 },
      { id:'k-club-vege', name:'Vege club sandwich z camembert, palonym awokado, majonezem, sałatą i pomidorem', price: 17 },
      { id:'k-jajecznica-avo', name:'Maślane pieczywo z jajecznicą, awokado i majonezem sriracha', price: 17 },
      { id:'k-buritto-chorizo', name:'Buritto z jajecznicą z mozzarellą, chorizo i majonezem sriracha', price: 19 },
      { id:'k-rostbef', name:'Maślane pieczywo z rostbefem, jajkiem poche, rukolą, sosem musztardowo-chrzanowym i oliwą truflową', price: 21 },
    ];

    const HEALTHY = [
      { id:'z-granola', name:'Domowa granola z jogurtem greckim, owoce i miód', price: 19 },
      { id:'z-cezar', name:'Sałatka Cezar z kurczakiem, bekonem, sałatą rzymską, parmezanem i grzankami', price: 19 },
      { id:'z-koreanska', name:'Sałatka koreańska z kurczakiem w panko, warzywa i sezam, słodki sos sojowy', price: 19 },
      { id:'z-burak', name:'Sałatka z carpaccio z buraka i serem kozim, karmelizowane orzechy pekan, mix sałat i pomarańczowy dressing', price: 19 },
    ];

    const SWEETS = [
      { id:'s-smoothie', name:'Smoothie Mango Lassi (mango, jogurt grecki, miód)', price: 19 },
      { id:'s-tost-fr', name:'Tost francuski z owocami i miodem', price: 19 },
      { id:'s-pancakes', name:'Pancakes (2 szt.) z Nutellą i owocami', price: 19 },
      { id:'s-deser-czeko', name:'Deser czekoladowy z owocami i kruszonką', price: 19 },
    ];

    const DRINKS = [
      { id:'n-lemoniada', name:'Domowa lemoniada 250 ml', price: 12 },
      { id:'n-sok-pom', name:'Sok pomarańczowy 250 ml', price: 12 },
      { id:'n-kawa-filt-cz', name:'Kawa filtrowana czarna 300 ml', price: 10 },
      { id:'n-kawa-filt-b', name:'Kawa filtrowana biała 300 ml', price: 10 },
      { id:'n-espresso-double', name:'Kawa czarna (podwójne espresso) 300 ml', price: 11 },
      { id:'n-flat-white', name:'Kawa Flat White (podwójne espresso) 300 ml', price: 11 },
      { id:'n-latte', name:'Latte (podwójne espresso) 300 ml', price: 12 },
      { id:'n-cappu', name:'Cappuccino (podwójne espresso) 300 ml', price: 11 },
      { id:'n-matcha', name:'Matcha 300 ml', price: 18 },
      { id:'n-herbata-cz', name:'Herbata czarna z cytryną 300 ml', price: 9 },
      { id:'n-zimowa', name:'Zimowa herbata z miodem, cytrusami, goździkami i sokiem malinowym 300 ml', price: 15 },
    ];

    const PRODUCTS = {
      'boxy-sniadaniowe': BREAKFAST_BOXES,
      'lunche': LUNCHES,
      'kanapki': SANDWICHES,
      'zdrowe': HEALTHY,
      'slodkie': SWEETS,
      'napoje': DRINKS,
    };

    /* =======================
       HELPERS / STATE
    ======================= */

    const useLocalStorage = (key, initial) => {
      const [state, setState] = useState(() => {
        try { return JSON.parse(localStorage.getItem(key)) ?? initial } catch { return initial }
      });
      useEffect(() => { localStorage.setItem(key, JSON.stringify(state)) }, [key, state]);
      return [state, setState];
    };

    const currency = (n) =>
      new Intl.NumberFormat('pl-PL', { style:'currency', currency:'PLN' }).format(n);

    const splitSubtitle = (text='') =>
      text.split('•').map(s => s.trim()).filter(Boolean);

    /* =======================
       TOAST
    ======================= */

    const ToastContext = React.createContext();
    const useToast = () => React.useContext(ToastContext);

    const ToastProvider = ({children}) => {
      const [toast, setToast] = useState(null);
      const tRef = React.useRef(null);

      const show = (message) => {
        setToast(message);
        if (tRef.current) clearTimeout(tRef.current);
        tRef.current = setTimeout(() => setToast(null), 1700);
      };

      return (
        <ToastContext.Provider value={{ show }}>
          {children}
          {toast && (
            <div className="fixed bottom-20 left-1/2 -translate-x-1/2 z-[80]">
              <div className="toastIn card px-4 py-3 flex items-center gap-3">
                <div className="w-8 h-8 rounded-full grid place-items-center font-black"
                     style={{background:"rgba(255,193,7,.22)", border:"1px solid rgba(255,193,7,.55)"}}>
                  ✓
                </div>
                <div className="text-sm font-extrabold">{toast}</div>
              </div>
            </div>
          )}
        </ToastContext.Provider>
      );
    };

    /* =======================
       CART
    ======================= */

    const CartContext = React.createContext();
    const useCart = () => React.useContext(CartContext);

    const CartProvider = ({children}) => {
      const [cart, setCart] = useLocalStorage('eatmi-cart', []);
      const toast = useToast();

      const add = (entry) => {
        const newItem = {
          id: (crypto?.randomUUID ? crypto.randomUUID() : `${Date.now()}-${Math.random()}`),
          qty: 1,
          ...entry
        };
        setCart(prev => [...prev, newItem]);
        toast?.show?.(entry.name);
      };

      const remove = (id) => setCart(prev => prev.filter(i => i.id !== id));
      const setQty  = (id, qty) => setCart(prev => prev.map(i => i.id === id ? {...i, qty: Math.max(1, qty|0)} : i));
      const incQty  = (id) => setCart(prev => prev.map(i => i.id === id ? {...i, qty: (i.qty||1)+1} : i));
      const decQty  = (id) => setCart(prev => prev.map(i => i.id === id ? {...i, qty: Math.max(1, (i.qty||1)-1)} : i));
      const clear = () => setCart([]);

      const lineTotal = (i) => (i.price || 0) * (i.qty || 1);
      const total = useMemo(() => cart.reduce((s,i)=> s + lineTotal(i), 0), [cart]);

      return (
        <CartContext.Provider value={{cart, add, remove, setQty, incQty, decQty, clear, lineTotal, total}}>
          {children}
        </CartContext.Provider>
      );
    };

    /* =======================
       UI: HEADER + NAV
    ======================= */

    const Logo = () => (
      <a href="#/" className="flex items-center gap-3">
        <div className="w-10 h-10 rounded-2xl grid place-items-center"
             style={{background:"rgba(255,193,7,.18)", border:"1px solid rgba(255,193,7,.55)"}}>
          <img src="https://i.imgur.com/f9TN0Gh.png" alt="eatmi.pl" className="w-9 h-9 object-contain" />
        </div>
        <span className="font-extrabold tracking-tight">
          eatmi<span className="text-brand-yellow">.pl</span>
        </span>
      </a>
    );

    const CartButton = () => {
      const { cart, total } = useCart();
      const count = cart.reduce((s,i)=>s+(i.qty||1),0);
      return (
        <a href="#/koszyk" className="btnO px-4 py-2 inline-flex items-center gap-2">
          <i data-lucide="shopping-cart" className="w-5 h-5"></i>
          <span className="font-extrabold">{currency(total)}</span>
          <span className="pillPrice text-xs">{count}</span>
        </a>
      );
    };

    const Header = () => (
      <header className="sticky top-0 z-40 bg-white border-b border-brand-line">
        <div className="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
          <Logo />
          <CartButton />
        </div>
      </header>
    );

    const BottomBar = () => {
      const { total, cart } = useCart();
      if (!cart.length) return null;
      return (
        <div className="fixed bottom-0 left-0 right-0 bg-white border-t border-brand-line z-40">
          <div className="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between gap-3">
            <div className="font-extrabold">{currency(total)}</div>
            <a href="#/koszyk" className="btnY px-5 py-3">
              Koszyk
            </a>
          </div>
        </div>
      );
    };

    /* =======================
       PAGES
    ======================= */

    const Home = () => (
      <section className="py-8 md:py-10">
        <div className="max-w-6xl mx-auto px-4">
          <h1 className="text-2xl md:text-3xl font-extrabold">
            Zamów online
          </h1>

          <div className="mt-5 grid md:grid-cols-3 gap-4">
            {PRODUCT_CATEGORIES.map(cat => (
              <button
                key={cat.id}
                onClick={() => window.location.hash = `#/kategoria/${cat.id}`}
                className="card p-5 text-left"
              >
                <div className="flex items-center justify-between">
                  <div className="font-extrabold text-lg">{cat.name}</div>
                  <div className="w-11 h-11 rounded-xl grid place-items-center"
                       style={{background:"rgba(255,193,7,.18)", border:"1px solid rgba(255,193,7,.55)"}}>
                    <i data-lucide={cat.icon} className="w-6 h-6"></i>
                  </div>
                </div>
              </button>
            ))}
          </div>
        </div>
      </section>
    );

    const ProductRow = ({ item, onAdd }) => {
      const bullets = splitSubtitle(item.subtitle || '');
      return (
        <div className="card p-4">
          <div className="flex items-start justify-between gap-3">
            <div className="min-w-0">
              <div className="font-extrabold">{item.name}</div>
              {bullets.length > 0 && (
                <div className="mt-2 text-sm text-brand-muted font-medium space-y-1">
                  {bullets.slice(0, 3).map((b, i) => (
                    <div key={i} className="flex gap-2">
                      <span className="mt-[7px] w-2 h-2 rounded-full bg-brand-yellow shrink-0"></span>
                      <span>{b}</span>
                    </div>
                  ))}
                </div>
              )}
            </div>

            <div className="text-right shrink-0">
              <div className="pillPrice">{currency(item.price)}</div>
              <button onClick={() => onAdd(item)} className="btnY mt-3 px-4 py-2">
                Dodaj
              </button>
            </div>
          </div>
        </div>
      );
    };

    const CategoryPage = ({ categoryId }) => {
      const { add } = useCart();
      const category = PRODUCT_CATEGORIES.find(c => c.id === categoryId);
      const items = PRODUCTS[categoryId] || [];

      if (!category) {
        return (
          <section className="py-8">
            <div className="max-w-6xl mx-auto px-4">
              <a className="btnO px-4 py-2 inline-block" href="#/">Wróć</a>
            </div>
          </section>
        );
      }

      const onAdd = (item) => add({
        type: 'product',
        productId: item.id,
        name: item.name,
        price: item.price
      });

      return (
        <section className="py-8 md:py-10">
          <div className="max-w-6xl mx-auto px-4">
            <div className="flex items-center justify-between gap-3">
              <a className="btnO px-4 py-2 inline-flex items-center gap-2" href="#/">
                <i data-lucide="arrow-left" className="w-4 h-4"></i> Wróć
              </a>
              <a className="btnY px-4 py-2" href="#/koszyk">Koszyk</a>
            </div>

            <h2 className="mt-4 text-2xl font-extrabold">{category.name}</h2>

            <div className="mt-5 space-y-3 pb-24">
              {items.map(item => (
                <ProductRow key={item.id} item={item} onAdd={onAdd} />
              ))}
            </div>
          </div>
        </section>
      );
    };

    const Koszyk = () => {
      const { cart, remove, clear, total, incQty, decQty, setQty, lineTotal } = useCart();
      const goToCheckout = () => window.location.hash = '#/zamowienie';

      return (
        <section className="py-8 md:py-10">
          <div className="max-w-6xl mx-auto px-4">
            <div className="flex items-center justify-between gap-3">
              <a className="btnO px-4 py-2 inline-flex items-center gap-2" href="#/">
                <i data-lucide="arrow-left" className="w-4 h-4"></i> Menu
              </a>
              {cart.length > 0 && (
                <button onClick={clear} className="btnO px-4 py-2">Wyczyść</button>
              )}
            </div>

            <h2 className="mt-4 text-2xl font-extrabold">Koszyk</h2>

            {cart.length === 0 ? (
              <div className="mt-4 card p-6">
                <div className="text-brand-muted font-medium">Koszyk jest pusty.</div>
              </div>
            ) : (
              <>
                <div className="mt-5 space-y-3">
                  {cart.map(item => (
                    <div key={item.id} className="card p-4">
                      <div className="flex flex-col md:flex-row md:items-center gap-4 justify-between">
                        <div className="min-w-0 flex-1">
                          <div className="font-extrabold break-words">{item.name}</div>
                          <div className="text-xs text-brand-muted mt-1 font-mono">{item.productId}</div>
                        </div>

                        <div className="flex items-center justify-between md:justify-end gap-4">
                          <div className="flex items-center gap-2">
                            <button onClick={()=> decQty(item.id)} className="btnO w-10 h-10">−</button>
                            <input
                              value={item.qty||1}
                              onChange={(e)=> setQty(item.id, parseInt(e.target.value||'1',10))}
                              className="w-16 text-center card focusY font-extrabold py-2"
                              inputMode="numeric"
                              pattern="[0-9]*"
                            />
                            <button onClick={()=> incQty(item.id)} className="btnY w-10 h-10">+</button>
                          </div>

                          <div className="text-right">
                            <div className="font-extrabold">{currency(lineTotal(item))}</div>
                            <button onClick={()=> remove(item.id)} className="text-red-600 font-extrabold text-sm hover:underline">
                              Usuń
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  ))}
                </div>

                <div className="mt-6 card p-5">
                  <div className="flex items-center justify-between">
                    <div className="font-extrabold">Suma</div>
                    <div className="font-extrabold text-xl">{currency(total)}</div>
                  </div>
                  <button onClick={goToCheckout} className="btnY w-full mt-4 px-5 py-3">
                    Zamów
                  </button>
                </div>
              </>
            )}
          </div>
        </section>
      );
    };

    const Zamowienie = () => {
      const { cart, total } = useCart();
      const [form, setForm] = useState({
        imieNazwisko:'', telefon:'', email:'', miasto:'', kod:'', ulica:'', nrBud:'', pietro:'', lokal:'', uwagi:'', faktura:false, nip:'', firma:''
      });
      const handle = (k,v)=> setForm(s=> ({...s,[k]:v}));

      const submit = async () => {
        if(!form.imieNazwisko || !form.telefon || !form.miasto || !form.ulica) {
          alert('Uzupełnij wymagane pola');
          return;
        }
        if (!cart.length) {
          alert('Koszyk jest pusty.');
          return;
        }
        const missing = cart.find(i => !i.productId);
        if (missing) {
          alert("W koszyku jest pozycja bez productId. Dodaj produkt ponownie.");
          console.log("Missing productId item:", missing);
          return;
        }

        try {
          const payload = {
            customer: form,
            cart: cart.map(i => ({ productId: i.productId, qty: i.qty || 1 }))
          };

          const r = await fetch("/api/payu/order", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(payload),
          });

          const data = await r.json().catch(() => ({}));

          if (!r.ok) {
            alert("Błąd serwera: " + (data.error || r.status));
            console.log("PAYU ERROR DETAILS:", data);
            return;
          }
          if (!data.redirectUri) {
            alert("Brak redirectUri. Zobacz konsolę (PAYU RESPONSE).");
            console.log("PAYU RESPONSE:", data);
            return;
          }
          window.location.href = data.redirectUri;
        } catch (e) {
          alert("Błąd połączenia z serwerem.");
          console.log(e);
        }
      };

      const Input = ({label, required, value, onChange, type="text"}) => (
        <div>
          <label className="text-xs uppercase tracking-widest font-extrabold text-brand-muted">
            {label}{required ? " *" : ""}
          </label>
          <input
            type={type}
            value={value}
            onChange={onChange}
            className="mt-1 w-full card focusY font-semibold px-4 py-3"
          />
        </div>
      );

      return (
        <section className="py-8 md:py-10">
          <div className="max-w-6xl mx-auto px-4">
            <div className="flex items-center justify-between gap-3">
              <a className="btnO px-4 py-2 inline-flex items-center gap-2" href="#/koszyk">
                <i data-lucide="arrow-left" className="w-4 h-4"></i> Koszyk
              </a>
              <div className="pillPrice">{currency(total)}</div>
            </div>

            <h2 className="mt-4 text-2xl font-extrabold">Dane do zamówienia</h2>

            <div className="mt-5 grid lg:grid-cols-3 gap-6 items-start pb-24">
              <div className="lg:col-span-2 card p-5">
                <div className="grid md:grid-cols-2 gap-4">
                  <Input label="Imię i nazwisko" required value={form.imieNazwisko} onChange={e=>handle('imieNazwisko', e.target.value)} />
                  <Input label="Telefon" required value={form.telefon} onChange={e=>handle('telefon', e.target.value)} />
                  <Input label="Email" value={form.email} onChange={e=>handle('email', e.target.value)} type="email" />
                  <Input label="Miasto" required value={form.miasto} onChange={e=>handle('miasto', e.target.value)} />
                  <Input label="Kod pocztowy" value={form.kod} onChange={e=>handle('kod', e.target.value)} />
                  <Input label="Ulica" required value={form.ulica} onChange={e=>handle('ulica', e.target.value)} />
                  <Input label="Nr budynku" value={form.nrBud} onChange={e=>handle('nrBud', e.target.value)} />
                  <Input label="Piętro" value={form.pietro} onChange={e=>handle('pietro', e.target.value)} />
                  <Input label="Nr lokalu" value={form.lokal} onChange={e=>handle('lokal', e.target.value)} />
                  <div className="md:col-span-2">
                    <label className="text-xs uppercase tracking-widest font-extrabold text-brand-muted">Uwagi</label>
                    <textarea
                      value={form.uwagi}
                      onChange={e=>handle('uwagi', e.target.value)}
                      className="mt-1 w-full card focusY font-semibold px-4 py-3 min-h-[110px]"
                    ></textarea>
                  </div>
                </div>

                <div className="mt-4 pt-4 border-t border-brand-line">
                  <label className="flex items-center gap-2 text-sm font-extrabold">
                    <input type="checkbox" checked={form.faktura} onChange={e=>handle('faktura', e.target.checked)} />
                    Faktura
                  </label>

                  {form.faktura && (
                    <div className="grid md:grid-cols-2 gap-4 mt-3">
                      <Input label="NIP" value={form.nip} onChange={e=>handle('nip', e.target.value)} />
                      <Input label="Nazwa firmy" value={form.firma} onChange={e=>handle('firma', e.target.value)} />
                    </div>
                  )}
                </div>
              </div>

              <aside className="card p-5">
                <div className="font-extrabold">Do zapłaty</div>
                <div className="mt-2 text-2xl font-extrabold">{currency(total)}</div>
                <button onClick={submit} className="btnY w-full mt-4 px-5 py-3">
                  PayU
                </button>
              </aside>
            </div>
          </div>
        </section>
      );
    };

    /* =======================
       ROUTER
    ======================= */

    const Router = () => {
      const [route, setRoute] = useState(window.location.hash || '#/');

      useEffect(()=>{
        const onHash = () => setRoute(window.location.hash || '#/');
        window.addEventListener('hashchange', onHash);
        return ()=> window.removeEventListener('hashchange', onHash);
      },[]);

      useEffect(()=> { window.lucide?.createIcons?.(); }, [route]);

      if (route.startsWith('#/kategoria/')) {
        const id = route.split('/')[2];
        return <CategoryPage categoryId={id} />;
      }
      if(route === '#/koszyk') return <Koszyk />;
      if(route === '#/zamowienie') return <Zamowienie />;
      return <Home />;
    };

    const App = () => (
      <ToastProvider>
        <CartProvider>
          <Header />
          <Router />
          <BottomBar />
          <footer className="py-10 text-center text-xs text-brand-muted font-medium">
            © {new Date().getFullYear()} eatmi.pl
          </footer>
        </CartProvider>
      </ToastProvider>
    );

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
